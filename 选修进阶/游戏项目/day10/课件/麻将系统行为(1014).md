一. 系统行为
游戏开始start_game --> 定庄|洗牌|发牌|摸牌
1. 定庄
第一局:  随机定庄(随机扔两个骰子)
第x局: 根据上一局的情况决定:
	有人胡牌(非通炮胡) : 胡牌的玩家是庄
	通炮胡:  点炮的玩家为庄
	无人胡牌: 沿用上一局的庄家或者随机
定庄之后清理上一局残留的信息

2. 发牌
先给桌子上所有玩家发13张牌
开始补花 -- 递归


修复bug,找问题时:
先了解需求逻辑,在脑海中有一套自己的流程

3. 游戏结算
跟庄结算:
	跟庄: 第一次出牌时剩下的玩家都打出和庄家一样的牌
杠结算:
	点杠/补杠/暗杠
胡牌结算:
	胡牌可能同时胡多种牌型, 清一色(4番) + 七小对(4番)
	杠: +杠数
	花: +花数
	亮倒:
	加固|加漂: +1, *x
	...

	抽象出一个公式: 从特殊推理到一般, 再用特殊情况验证推理出的公式是否使用

	某玩家胡牌的计算公式为：
        y = (A(x+B)+C) * D    # 如果A,C,D不配置     y=(1*(x+B)+0)*1
        y 为 胡牌最终番数， X为基本胡法番数， 如碰碰胡清一色共4番，x=4
        A = A1*A2*..., A为算最终番数相乘的因子积
        B = B1+B2+..., B为算番时和基础番数相加的因子和
        C = C1+C2+..., C为算最终番时相加的因子积
        D = D1*D2*..., A为算最终番数相乘的因子积

    game/mahjong/models/systemact/settle.py
    	compute_tmp_fan(): 二人麻将胡牌结算  -- 偷懒
    	compute_last_fan(): 多人麻将结算
    		get_settle_hu_fan() 计算某个玩家某次胡牌中的输赢情况

跟踪某个消息时,当你没有办法从入口处去跟踪 (比如你不知道消息名字是什么):
1. 猜测的关键词搜索, 游戏结束, over, exit
2. 从目录和文件名推断 



麻将扩展作业:
1. 超时自动出牌bug怎么修复

2. 新增一种胡牌玩法
比如清碰胡牌牌型:
代码修改哪几个文件
如何测试

提示:胡牌调用的流程, 类型定义,注册, 基本胡,特殊胡法


麻将项目要求:
a. 不计划用这个项目
	注册功能调通

b. 面试想用到,主要目的为面试,觉得以后做麻将的可能性不是很大
	注册功能调通
	简历上想写的麻将规则熟悉
	麻将项目详细通信流程
	麻将实现思路

c. 面试, 工作后能用到它做一款麻将
	注册功能调通
	简历上想写的麻将规则熟悉
	麻将项目详细通信流程
	麻将实现思路

	调一下倒计时的bug
	新增的胡法
	模拟用户测试


初级开发工程师
1. 添加小功能|需求
2. 修复某一个bug
3. 解决某一个性能问题





-- 通信架构图:
消息流程走向

client --> web server--> 返回ip:port 给到client
client --> proxy--> gate-->game
db(redis, mysql)

gate-->web server
nginx 
uwsgi
分布式
celery
监控
测试
预警
运维


-- 接口服务卡顿
消息流程走向:
客户自身网络--> nginx--> django -> 程序代码耗时模块(网络请求, 循环, 复杂计算, db) --> 服务器负载,有木有干扰项 --> db(数据规模,索引,sql语句, 死锁, 慢查询)

不同层级:
代码层面:
程序代码耗时模块(网络请求, 循环, 复杂计算, db)

机器层面:
代理, 服务, 数据库所在机器 是否一直正常

数据库层面,三方服务
 db(数据规模,索引,sql语句, 死锁, 慢查询)


-- 最有价值的事
问题: mysql, redis, celery, django, flask, tornado ... 出现的问题, bug, 异常, 难点
技术: bloom数据库, 布谷鸟算法, lru_cache装饰器, pyrasite...
推动工作: 编码规范, 问题记录(测试规范,上线规范,流程规范)...
责任心: ...




后续要求:
每个人做一张的后续10月21号--就业结束的计划表
第一天: python相关
第二天: db相关
第三天: 多路复用框架相关
第四天: 其他,MQ,DevOps, 后台优化
第五天: 算法
第六第七天: 面试题

两天-三天测试







