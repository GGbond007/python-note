一. 麻将胡牌设计
1. 断线重连
第一种: 
	用户登录时判断之前是否在游戏中,如果在游戏中,则直接返回现场信息;
	 --- 客户端改动相对较大, 客户端登录接口判断是否是返回的重连信息;
第二种:
	用户登录时判断之前是否在游戏中,如果在游戏中,通知客户端之前在线,由客户端发送一个重连请求;
		--- 流程安全隐患

2. 如何学习一个新项目
a. 弄清楚这个项目做什么,有什么功能;
b. 项目用到了哪些大的技术;
c. 运行项目;
d. 从启动文件找入口;
e. 选择一条消息从入口往下捋,直到消息返回;
f. 弄清楚代码层次结构,每个目录功能;
g. 捋剩下的消息,同时可以开始调试,添加一些小需求 --- 做项目阶段

3. 麻将胡牌
a. 原则: 
性能好: 
	数量:判断次数少 (架构设计) 
	单次性能:每次判断花费时间少(算法思路,不同的算法性能不一样)

b. 麻将胡法之间是有一定的联系,比如碰碰胡一定也是平胡, 豪华七小对一定是七小对...
规律: 很多种胡法满足的基础前提是  满足一些基本的胡法,比如平胡, 七小对, 十三幺   --- 从多种胡法中总结规律

基本胡法: 平胡|屁胡, 七小对, 十三幺
特殊胡法: 九莲宝灯, 碰碰胡, 豪华七小对, ...
	碰碰胡 -- 平胡


c. 判胡|判听:
	首先判断的是该手牌是否符合某一种或几种基本胡;     --- 将判胡次数从几十几百次缩减到三次
	若所有的基本胡都不符合,则直接返回;
	若满足某一种基本胡,则再判断该基本胡基础上的特殊胡法;  --- 缩减需要判断的特殊胡法种类

d. 麻将内部代码结构:   -- 可选
models  麻将模型/行为/方法等
	card  麻将牌的处理相关
	config  配置相关
	hutype  胡牌相关
		eight:  胡牌番数为8番的=胡法
		...
		basetype.py 胡牌类型的基类
		typemanager.py 胡牌控制相关


	playeract 玩家行为
	systemact 系统行为
	utils 工具方法
	actrecord.py  操作记录
	callbackmanager.py 回调管理器   
	gamedata.py  游戏的全局数据(每桌一个game_data实例对象)
	player.py    玩家类
	state_machine.py   忽略
	time_manager.py 计时任务管理

e. 胡牌判断入口:
	typemanager.py/check_hu_result()       --- 视情况记住
	1. 如果是点炮胡判断，则将可能点炮的牌加到⼿牌中
	2. 检查⼿牌是否符合基本胡牌类型
	3. 如果可以胡某些基本胡牌类型，则再判断可以胡哪些特殊胡法
	4. 点炮胡时再从⼿牌中将点炮牌去掉
	5. 去除发⽣互斥的胡牌类型

f. 手牌表示
	models/card/hand_card.py 
		hand_card_info:   手牌信息（不包括吃碰杠的牌）,立着的别人看不见的你的牌     --- 必须记住
		  初始化时:
		  {
		  	万: [3, 2, 1, 0, 0, 0, 0, 0, 0, 0],   第0位表示该种花色的手牌总数, 	 (不需要遍历所有的万就可以统计万花色的张数)
		  									第1位到第9位对应的一万到九万每张牌的张数
		  	饼: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
		  	条: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
		  	风: [0, 0, 0, 0, 0],
		  	...
		  }
		union_card_info:  全部手牌信息（包括吃碰杠）

g. 听牌接口
	复杂度是胡牌算法的14倍

h. 胡牌算法:
	平胡:   models/utils/pihu_analyse.py
	13张牌判断可以胡哪些牌?   
		 在13张牌中再加一张癞子牌(万能牌) 组成了14张牌, 判断14张牌能否组成平胡
		 如果可以, 则癞子当的牌就是可以胡的牌

		 如: 二万,三万,癞子(当一万/四万)   一条,二条,三条, 四条,五条,六条, 七条,八条,九条 东风,东风
		 	结果胡一四万

		平胡模块入口: get_hu_detail()

		平胡算法核心思想:     -- 记住思想,代码暂不建议细看
			先找所有将牌组合
			然后判断剩下的牌是否全部都能组成刻字或者顺子 --- 递归思路
			手牌的列表是有序的,按照牌值大小升序或者降序排列
			比如12张牌, 第一张是二万,第二张是五万,则直接返回,该组合不可能为平胡

			癞子是用来查漏补缺
			假如有四张癞子红中,判断可以胡哪些牌时, 相当于5张癞子
				将牌组合9种
				去掉第一种将(假如包括一张癞子)
				剩下12张牌(四张癞子)
				非癞子牌:  一万, 五万, ....
					拿两个癞子当两个一万或者一个二万和三万

			癞子用10000表示
			[[[17,10000,10000], [21, 22, 23], [22, 23,24], [33, 33, 33]], [49,49]]
			[17, 10000, 10000]   --> [10000, 10000]  当成[17, 17]和[18, 19]

	七小对:      -- 记住思想, 建议写一写
		手牌都是有序的
		[17,18,0,18,19,..., 10000]	
		先统计排除癞子的情况下,剩下的牌有几对
			比如剩下的牌有6对(12张), 剩下的牌就是单张和癞子
			如果只有5对(10张牌), 剩下的牌4张  17 ,20, 22, 10000
				判断癞子数是否>=缺的对子数

	十三幺:(一万,九万,一饼,九饼,一条九条,东西南北中发白,胡牌时再加其中的任何一张牌即可胡)   -- 思想记住
		将⼗三⺓的牌变成集合 减去 ⼿牌集合， 差集即为胡⼗三⺓缺的牌；
		差集: A - B = C(A有的但B没有的部分)
		上⼀步缺的牌数是否⼩于癞⼦数，如果⼩于，则可以胡⼗三⺓；


作业: 游戏开始 --- .... ---结束  中间经历了什么, 消息怎么走的   bridgecontroller.py/start_game()   ---> bridgecontroller.py/notify_desk_game_over()

王斯杰,姚承政,徐敬雄,黄义镇,何键翰,王博

